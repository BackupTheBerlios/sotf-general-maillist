<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Sotf-general] the waiting is over - happy sotf video node          testing!!!
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/sotf-general/2006-May/index.html" >
   <LINK REL="made" HREF="mailto:sotf-general%40lists.berlios.de?Subject=Re%3A%20%5BSotf-general%5D%20the%20waiting%20is%20over%20-%20happy%20sotf%20video%20node%20%20%20%20%20%0A%20%20%20%20%20testing%21%21%21&In-Reply-To=%3C40566.195.177.250.8.1148408235.squirrel%40195.177.250.8%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000224.html">
   <LINK REL="Next"  HREF="000226.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Sotf-general] the waiting is over - happy sotf video node          testing!!!</H1>
    <B>roland</B> 
    <A HREF="mailto:sotf-general%40lists.berlios.de?Subject=Re%3A%20%5BSotf-general%5D%20the%20waiting%20is%20over%20-%20happy%20sotf%20video%20node%20%20%20%20%20%0A%20%20%20%20%20testing%21%21%21&In-Reply-To=%3C40566.195.177.250.8.1148408235.squirrel%40195.177.250.8%3E"
       TITLE="[Sotf-general] the waiting is over - happy sotf video node          testing!!!">janki at yaya23.net
       </A><BR>
    <I>Tue May 23 20:17:15 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000224.html">[Sotf-general] the waiting is over - happy sotf video node     testing!!!
</A></li>
        <LI>Next message: <A HREF="000226.html">[Sotf-general] the waiting is over - happy sotf video node               testing!!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#225">[ date ]</a>
              <a href="thread.html#225">[ thread ]</a>
              <a href="subject.html#225">[ subject ]</a>
              <a href="author.html#225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hi martin,

auf was f&#252;r hardware fahrt ihr euren testnode, mein athlon xp 2ghz
1024ram kommt ziemlich ins schwitzen bei groesseren files, hab
das mem limit nun auf 384 gesetzt aber die antwortzeiten sind sehr
sehr lange....

btw,
admin/xaok fall du reinschauen willst bzw dir nen user anlegen



Martin Schmidt said:
&gt;<i>
</I>&gt;&gt;<i>hey all,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Hi Roland,
</I>&gt;<i>
</I>&gt;&gt;<i>just finished to install the video_test branch on <A HREF="http://video.xaok.org,">http://video.xaok.org,</A>
</I>&gt;&gt;<i>first of all congratulations to the developers, thats a big step forward
</I>&gt;&gt;<i> for
</I>&gt;&gt;<i>sotf.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Thank you.
</I>&gt;<i>
</I>&gt;&gt;<i>some findings:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>1.) installation
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>1a.)
</I>&gt;&gt;<i>db.sql had to be created manually on the command line, there was no more
</I>&gt;&gt;<i>&quot;create nodedb&quot; button in install/install.php
</I>&gt;&gt;<i>-&gt; maybe because an empty DB was created manually before?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> I have neighter seen such a button ever in SOTF nor changed install.php
</I>&gt;<i> in any way. I've always created my databases manually, also on my audio
</I>&gt;<i> node installations.
</I>&gt;<i>
</I>&gt;&gt;<i>1b.)
</I>&gt;&gt;<i>view 'ftp_auth' had to be redefined to prefix BASEDIR in 'homedir' field
</I>&gt;&gt;<i>(maybe an sideeffect from 1a?)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> I noticed that, too. But - according to the BerliOS WebSVN - this change
</I>&gt;<i> dates back to revision 349 on 2003-12-18! :)
</I>&gt;<i>
</I>&gt;&gt;<i>2.) video specific issues
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>2a.)
</I>&gt;&gt;<i>flash player seems to consume enormous amounts of mem with huge files:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>when trying to preview <A HREF="http://video.xaok.org/get.php?id=911pr1">http://video.xaok.org/get.php?id=911pr1</A>
</I>&gt;&gt;<i>with  memory_limit = 128M  in php.ini this error rises:
</I>&gt;&gt;<i>---------
</I>&gt;&gt;<i>Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to
</I>&gt;&gt;<i>allocate 143070438 bytes) in
</I>&gt;&gt;<i>/data/hosting/xaoknode/node/code/getid3-1.7.5/getid3/module.audio-video.flv.php
</I>&gt;&gt;<i>on line 26
</I>&gt;&gt;<i>---------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>setting memory_limit = 256M (which is of course not very reasonable...)
</I>&gt;&gt;<i>kicks apache in a very unstable state consuming 99.5% cpu and 200megs+ of
</I>&gt;&gt;<i>memory.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i><A HREF="http://video.xaok.org/get.php?id=911pr1">http://video.xaok.org/get.php?id=911pr1</A> claims that there is no flash
</I>&gt;&gt;<i>preview available or the scripts times out (randomly)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> I have to admit, that we are running with memory_limit = 512M... :)
</I>&gt;<i>
</I>&gt;<i> If the script times out, raise the max_execution_time in php.ini. The
</I>&gt;<i> first time you call get.php for a certain programme, it's running a bit
</I>&gt;<i> longer as the converted files have to be processed. Here, the video
</I>&gt;<i> files (which of course might be very big, much more than 128mb... *g*)
</I>&gt;<i> have to be moved from the tmpdir into the repository and their file
</I>&gt;<i> information has to be stored in the db. That's the thing which consumes
</I>&gt;<i> the ressources!
</I>&gt;<i>
</I>&gt;<i> You can shorten this process if you wait in editFiles.php for the
</I>&gt;<i> transcoding process to finish or visit the page again after you think
</I>&gt;<i> it's done. Then, the file movements are done there, which should go
</I>&gt;<i> faster.
</I>&gt;<i>
</I>&gt;<i> The flash preview is of course only available if the accordant flv file
</I>&gt;<i> has been converted.
</I>&gt;<i> As the memory limit seems to have been set down again, i could not see
</I>&gt;<i> the programme as i visited the link.
</I>&gt;<i>
</I>&gt;&gt;<i>2b)
</I>&gt;&gt;<i>transcode functions
</I>&gt;&gt;<i>as i can see from the process list several ffmpegs are fired up when
</I>&gt;&gt;<i>pressing &quot;convert all required...&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>this is ok on an openmosix cluster environment with several cpu's but on
</I>&gt;&gt;<i> a
</I>&gt;&gt;<i>single cpu machine this could easily take down the whole machine, imagine
</I>&gt;&gt;<i>30 ffmpegs trying to convert 1GB of video data each... for production use
</I>&gt;&gt;<i>there should be a queue and a max-concurrent-transcode-process config
</I>&gt;&gt;<i>value
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> For this reason, the ffmpegs are (preliminarily) run with &quot;nice -n 15&quot;.
</I>&gt;<i> That reduces the amount of memory and cpu they might consume. As the
</I>&gt;<i> nice factor could apparently be even higher in some cases (reducing the
</I>&gt;<i> ressources again), I will add it as a config parameter.
</I>&gt;<i>
</I>&gt;<i> $config['maxtranscodeprocesses'] is a good idea, however (although I
</I>&gt;<i> have no idea how to realize this queue at the moment).
</I>&gt;<i>
</I>&gt;&gt;<i>2c)
</I>&gt;&gt;<i>support of open formats - OGG/THEORA video
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>this i more a feature request than a bug. in the present state ogg/theora
</I>&gt;&gt;<i>video format is not supported at all, neither as input format nor as an
</I>&gt;&gt;<i>convert target.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>for the node to be attractive to creative commons producers and/or the
</I>&gt;&gt;<i>indymedia univers it would be crucial to support this free format.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>martin, is there any easy way to get theora support in there? relavant
</I>&gt;&gt;<i>command line tools are ffmpeg2theora (<A HREF="http://v2v.cc/~j/ffmpeg2theora/">http://v2v.cc/~j/ffmpeg2theora/</A>)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>ffmpeg supports decoding anyway (from the ffmpeg site: &quot;Put another way,
</I>&gt;&gt;<i>FFmpeg supports Theora video decoding&quot;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>if you are not interested to integrate it, could you give me some hints
</I>&gt;&gt;<i>where to start, eg. wich classes have to be modified?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> That's easy, no classes have to be modified for that at all! All
</I>&gt;<i> possible ffmpeg parameters (and important error messages) can be found
</I>&gt;<i> in config.inc.php for every node administrator to adapt for his needs.
</I>&gt;<i> You can change, add or remove file types as you like. (&gt;&gt;
</I>&gt;<i> <A HREF="http://ffmpeg.sourceforge.net/ffmpeg-doc.html">http://ffmpeg.sourceforge.net/ffmpeg-doc.html</A>) If you have a problem
</I>&gt;<i> with your server ressources, you possibly should reduce the bandwidth of
</I>&gt;<i> the video files there, too.
</I>&gt;<i>
</I>&gt;&gt;<i>i'll keep you informed on new findings,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Thank you.
</I>&gt;<i>
</I>&gt;<i> By the way: what about the new topic tree, haven't you tested the script
</I>&gt;<i> on the orange database? It doesn't figure in your bug report, at least.
</I>&gt;<i>
</I>&gt;&gt;<i>cheers,
</I>&gt;&gt;<i>roland jankowski
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Greetings,
</I>&gt;<i> Martin
</I>&gt;<i>
</I>&gt;&gt;<i>btw, alternatives for the embedded flash player could
</I>&gt;&gt;<i><A HREF="http://www.flumotion.net/cortado/">http://www.flumotion.net/cortado/</A> (the world social forum was using this
</I>&gt;&gt;<i>for video broadcasting last year)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Sotf-general mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sotf-general">Sotf-general at lists.berlios.de</A>
</I>&gt;<i> <A HREF="http://lists.berlios.de/mailman/listinfo/sotf-general">http://lists.berlios.de/mailman/listinfo/sotf-general</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000224.html">[Sotf-general] the waiting is over - happy sotf video node     testing!!!
</A></li>
	<LI>Next message: <A HREF="000226.html">[Sotf-general] the waiting is over - happy sotf video node               testing!!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#225">[ date ]</a>
              <a href="thread.html#225">[ thread ]</a>
              <a href="subject.html#225">[ subject ]</a>
              <a href="author.html#225">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/sotf-general">More information about the Sotf-general
mailing list</a><br>
</body></html>
